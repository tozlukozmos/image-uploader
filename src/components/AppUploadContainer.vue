<script setup>
import { ref } from 'vue';

const props = defineProps({
    upload: Function,
})

const isActive = ref(false);
const errorMessage = ref('');

const toggleActive = () => {
    isActive.value = !isActive.value;
}
const drop = (e) => {
    isActive.value = !isActive.value;
    const image = e.dataTransfer.files[0];
    if (image.type.startsWith('image/')) {
        props.upload(image);
    } else {
        errorMessage.value = 'File should be image';
    }
}
const choose = () => {
    const image = document.getElementById('image').files[0];
    props.upload(image);
}
</script>

<template>
    <app-alert v-if="errorMessage.length > 0" type="danger" :message="errorMessage" />
    <section class="container">
        <h1 class="title">Upload your image</h1>
        <p class="message">File should be JPEG, PNG, GIF...</p>
        <section 
        :class="isActive ? 'drop-zone-active' : 'drop-zone'" 
        @dragenter.prevent="toggleActive"
        @dragleave.prevent="toggleActive" 
        @dragover.prevent 
        @drop.prevent="drop">
            <svg width="80" height="80" viewBox="0 0 130 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M30.2783 14.1798C28.3943 14.1784 26.5357 14.6142 24.8488 15.453C23.1618 16.2918 21.6926 17.5107 20.5567 19.0138C19.3375 18.4891 18.007 18.2754 16.6848 18.3918C15.3626 18.5083 14.09 18.9513 12.9813 19.681C11.8725 20.4107 10.9624 21.4044 10.3325 22.5727C9.70255 23.7411 9.37263 25.0475 9.37231 26.3749H42.4734C42.4734 24.7734 42.1579 23.1876 41.5451 21.708C40.9322 20.2284 40.0339 18.884 38.9015 17.7516C37.7691 16.6192 36.4247 15.7209 34.9451 15.108C33.4655 14.4952 31.8797 14.1798 30.2783 14.1798V14.1798Z"
                    fill="#CCCCCC" />
                <path
                    d="M86.5981 7.77704C85.0711 7.77591 83.5647 8.12919 82.1974 8.80907C80.8301 9.48895 79.6392 10.4769 78.7185 11.6951C77.7303 11.2699 76.652 11.0967 75.5803 11.1911C74.5086 11.2855 73.4771 11.6445 72.5785 12.236C71.6798 12.8274 70.9421 13.6328 70.4315 14.5798C69.921 15.5267 69.6536 16.5857 69.6533 17.6615H96.4826C96.4826 16.3635 96.2269 15.0781 95.7302 13.8789C95.2334 12.6796 94.5054 11.59 93.5875 10.6721C92.6697 9.75427 91.58 9.02618 90.3808 8.52944C89.1815 8.0327 87.8962 7.77704 86.5981 7.77704Z"
                    fill="#E6E6E6" />
                <path
                    d="M123.66 0.936768H6.23877C4.66849 0.938991 3.16315 1.56377 2.05279 2.67413C0.94243 3.78449 0.317653 5.28983 0.31543 6.86011V95.0134C0.317652 96.5837 0.94243 98.0891 2.05279 99.1994C3.16315 100.31 4.66849 100.935 6.23877 100.937H123.66C125.231 100.935 126.736 100.31 127.846 99.1994C128.957 98.0891 129.582 96.5837 129.584 95.0134V6.86011C129.582 5.28983 128.957 3.78449 127.846 2.67413C126.736 1.56377 125.231 0.938991 123.66 0.936768V0.936768ZM128.887 95.0134C128.885 96.3991 128.334 97.7275 127.354 98.7072C126.374 99.687 125.046 100.238 123.66 100.24H6.23877C4.85314 100.238 3.52474 99.687 2.54495 98.7072C1.56516 97.7275 1.01398 96.3991 1.01229 95.0134V6.86011C1.01398 5.47448 1.56516 4.14609 2.54495 3.1663C3.52474 2.18651 4.85314 1.63531 6.23877 1.63363H123.66C125.046 1.63531 126.374 2.18651 127.354 3.1663C128.334 4.14609 128.885 5.47448 128.887 6.86011V95.0134Z"
                    fill="#C2C2C2" />
                <path
                    d="M86.8052 64.3514C101.334 64.3514 113.112 52.5735 113.112 38.0448C113.112 23.516 101.334 11.7382 86.8052 11.7382C72.2764 11.7382 60.4985 23.516 60.4985 38.0448C60.4985 52.5735 72.2764 64.3514 86.8052 64.3514Z"
                    fill="#AAC7E1" />
                <path
                    d="M129.584 75.5256V82.8183H0.31543V75.4908L1.0123 74.4873L41.9949 15.4734C42.1808 15.2056 42.4288 14.9868 42.7176 14.8358C43.0064 14.6847 43.3275 14.6058 43.6535 14.6058C43.9794 14.6058 44.3005 14.6847 44.5893 14.8358C44.8782 14.9868 45.1261 15.2056 45.312 15.4734L72.7963 55.0448L92.3607 27.1215C92.5469 26.8552 92.7945 26.6377 93.0826 26.4876C93.3708 26.3375 93.6909 26.2591 94.0158 26.2591C94.3407 26.2591 94.6608 26.3375 94.9489 26.4876C95.237 26.6377 95.4847 26.8552 95.6708 27.1215L128.887 74.5291L129.584 75.5256Z"
                    fill="#9E9E9E" />
                <path
                    d="M28.7127 91.1807H8.15522C8.063 91.1804 7.97465 91.1436 7.90954 91.0783C7.84442 91.013 7.80786 90.9245 7.80786 90.8323C7.80786 90.74 7.84442 90.6516 7.90954 90.5863C7.97465 90.5209 8.063 90.4841 8.15522 90.4838H28.7127C28.8051 90.4838 28.8938 90.5205 28.9591 90.5859C29.0244 90.6512 29.0611 90.7399 29.0611 90.8323C29.0611 90.9247 29.0244 91.0133 28.9591 91.0786C28.8938 91.144 28.8051 91.1807 28.7127 91.1807V91.1807Z"
                    fill="#C2C2C2" />
                <path
                    d="M59.7232 91.1807H39.1657C39.1198 91.1808 39.0744 91.1719 39.032 91.1545C38.9896 91.137 38.9511 91.1114 38.9186 91.079C38.8861 91.0467 38.8604 91.0082 38.8428 90.9659C38.8252 90.9235 38.8162 90.8781 38.8162 90.8323C38.8162 90.7864 38.8252 90.741 38.8428 90.6987C38.8604 90.6563 38.8861 90.6179 38.9186 90.5855C38.9511 90.5531 38.9896 90.5275 39.032 90.51C39.0744 90.4926 39.1198 90.4837 39.1657 90.4838H59.7232C59.8156 90.4838 59.9042 90.5205 59.9695 90.5859C60.0349 90.6512 60.0716 90.7399 60.0716 90.8323C60.0716 90.9247 60.0349 91.0133 59.9695 91.0786C59.9042 91.144 59.8156 91.1807 59.7232 91.1807V91.1807Z"
                    fill="#C2C2C2" />
                <path
                    d="M90.7337 91.1807H70.1762C70.084 91.1804 69.9957 91.1436 69.9305 91.0783C69.8654 91.013 69.8289 90.9245 69.8289 90.8323C69.8289 90.74 69.8654 90.6516 69.9305 90.5863C69.9957 90.5209 70.084 90.4841 70.1762 90.4838H90.7337C90.8261 90.4838 90.9148 90.5205 90.9801 90.5859C91.0455 90.6512 91.0822 90.7399 91.0822 90.8323C91.0822 90.9247 91.0455 91.0133 90.9801 91.0786C90.9148 91.144 90.8261 91.1807 90.7337 91.1807V91.1807Z"
                    fill="#C2C2C2" />
                <path
                    d="M121.744 91.1807H101.186C101.094 91.1804 101.006 91.1436 100.941 91.0783C100.876 91.013 100.839 90.9245 100.839 90.8323C100.839 90.74 100.876 90.6516 100.941 90.5863C101.006 90.5209 101.094 90.4841 101.186 90.4838H121.744C121.836 90.4838 121.925 90.5205 121.99 90.5859C122.056 90.6512 122.092 90.7399 122.092 90.8323C122.092 90.9247 122.056 91.0133 121.99 91.0786C121.925 91.144 121.836 91.1807 121.744 91.1807V91.1807Z"
                    fill="#C2C2C2" />
                <path
                    d="M65.4723 24.2817C63.5884 24.2803 61.7298 24.7162 60.0429 25.555C58.3559 26.3938 56.8867 27.6127 55.7508 29.1157C54.5316 28.5911 53.2011 28.3774 51.8789 28.4938C50.5567 28.6103 49.2841 29.0533 48.1754 29.783C47.0666 30.5127 46.1564 31.5064 45.5265 32.6747C44.8966 33.8431 44.5667 35.1495 44.5664 36.4769H77.6675C77.6675 34.8754 77.352 33.2896 76.7392 31.81C76.1263 30.3304 75.228 28.986 74.0956 27.8536C72.9632 26.7212 71.6188 25.8229 70.1392 25.21C68.6596 24.5972 67.0738 24.2817 65.4723 24.2817V24.2817Z"
                    fill="#CCCCCC" />
            </svg>
            <p class="drop-zone-message">Drag & Drop your image here</p>
        </section>
        <p class="divider">Or</p>
        <label class="button-primary">
            Choose a file
            <input 
            type="file" 
            name="image" 
            id="image" 
            @change="choose" 
            accept="image/*" 
            style="display: none;">
        </label>
    </section>
</template>

<style scoped>
.container {
    width: 300px;
    padding: 24px;
    box-shadow: 0px 0px 8px var(--grey40);
    border-radius: 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.title {
    font-size: 16px;
    font-weight: 500;
}

.message {
    margin-top: 24px;
    font-size: 12px;
    color: var(--grey60);
}

.drop-zone {
    margin-top: 24px;
    width: 100%;
    aspect-ratio: 3/2;
    padding: 24px;
    border: 1.4px dashed var(--primary-border);
    background: var(--primary-bg);
    border-radius: 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    transition: .3s ease all;
}

.drop-zone-active {
    margin-top: 24px;
    width: 100%;
    aspect-ratio: 3/2;
    padding: 24px;
    border: 1.4px dashed var(--primary);
    background: var(--primary-bg);
    border-radius: 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    transition: .3s ease all;
}

.drop-zone-message {
    margin-top: 16px;
    font-size: 12px;
    color: var(--grey60);
    user-select: none;
}

.divider {
    margin-top: 16px;
    font-size: 12px;
    color: var(--grey60);
}

.button-primary {
    margin-top: 16px;
    user-select: none;
}
</style>